{% if inventory_hostname != groups["control_plane"][0] %}
server: https://{{ rke2_master_ipv4 }}:9345
token: {{ rke2_master_token }}

{% endif %}
cni: cilium

node-ip: {{ node_private_ipv4 }}
node-external-ip: "{{ node_public_ipv4 }},{{ node_public_ipv6 }}"

disable: rke2-ingress-nginx
disable-kube-proxy: true
kube-controller-manager-arg: "--controllers=*,-nodeipam"

service-node-port-range: 1-65535

{% if "control_plane" in group_names %}
cluster-cidr: 10.42.0.0/16
service-cidr: 10.43.0.0/16
{% endif %}
